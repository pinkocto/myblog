---
title: "ARIMA"
author: 'jiyun Lim'
date: '03/01/2023'
categories: 
  - R
  - TS
  - ML
format:
  html:
    theme: default
---

## ARIMA


ARIMA 모형은 현 시점의 관측값 $Z_n$을 과거의 관측값 $\{Z_t, \space t<n\}$ 들과 백색잡음(white noise)이라고 부르는 오차 $\{\epsilon_t, \space t\leq n\}$ 의 선형결합인
$$Z_n = f(Z_1, Z_2, \dots, Z_{n-1}, \epsilon_1, \epsilon_2, \dots, \epsilon_{n-1}) + \epsilon_n$$
의 형태로 표현하는 모형으로, 1970년대에 들어와서 Box와 Jenkins가 ARIMA모형을 적합키는 3단계 절차를 제안한 이후로는 박스-젠킨스 모형(Box-Jenkins model)이라는 이름으로 가장 많이 사용되고 있다.

특히 평활법에 의한 예측방법 가각ㄱ에는 이에 대응되는 추세모형^[가중최소제곱법을 이용한]이 존재하며, 이들 또한 ARIMA 모형을 이용한 예측법 중에서 특별한 경우에 해당된다는 것이 밝혀져 있다.^[Abraham and Ledolter(1983)]

여러 개의 시계열변수들로 구성된 벡터 시계열 분석에는 벡터 ARMA(VARMA) 모형을 이용한다.

## Libraries

```{r, message=FALSE}
library(forecast)
library(tseries)

library(data.table)
library(tidyverse)
```

## AirPassengers

```{r}
AP <- AirPassengers
AP
```

```{r}
AP %>% glimpse()
```
```{r}
class(AP) # ts 객체 (시계열 데이터를 처리하기 위한 속성)
```

```{r}
start(AP); end(AP)
```

```{r}
frequency(AP)
```
```{r}
plot(AP)
```

```{r}
cycle(AP)
```
```{r}
boxplot(AP ~ cycle(AP))
```


## Maine

> 1996.1월부터 2006.8 미국 maine 주의 월별 실업률

```{r}
library(tidyverse)
library(data.table)
library(ggplot2)
library(ggfortify)

```


```{r}
Maine <- fread('./timeseries/Maine.txt')
Maine %>% head()

```

```{r}
str(Maine)
```

```{r}
class(Maine)
```


## ts객체로 변환
**ts(data, start, end, frequency = 12, ...)**

```{r}
Maine.ts <- ts(Maine$unemploy, start = c(1996,1), frequency = 12)
class(Maine.ts)
```


```{r}
plot(Maine.ts)
```

```{r}
Maine.2000 <- window(Maine.ts, start = c(2000,1))
plot(Maine.2000)
```


### Multiple timeseries plot

```{r}
cbe <- fread('./timeseries/cbe.txt')
cbe %>% head()
```


```{r}
choc.ts <- ts(cbe$choc, start = 1958, freq=12)
beer.ts <- ts(cbe$beer, start = 1968, freq=12)
elec.ts <- ts(cbe$elec, start = 1968, freq=12)

plot(cbind(choc.ts, beer.ts, elec.ts), main='')
```

```{r}
cbe %>% 
  ts(start = 1958, freq=12) %>% 
  autoplot(facets = T)
```
```{r}
global <- fread('./timeseries/global.txt')
global %>% head()
```

```{r}
global_s <- scan('./timeseries/global.txt')
global_s %>% head()
```

```{r}
global_s %>% glimpse()
```

```{r}
plot(global_s, type = 'l')
```
```{r}
global.ts <- ts(global_s, start = c(1856, 1), freq = 12)
plot(global.ts, main='')
```


```{r}
autoplot(global.ts)
```


### 회귀직선 추가

```{r}
new.time <- time(global.ts) # t+(i-1)/freq
plot(global.ts, main='')
abline(lm(global.ts~new.time), col = 'red')
```


```{r}
global.ts %>% str()
```

```{r}
#autoplot(global.ts) +
 # geom_smooth(method = 'lm')
```


##  시계열 모형 소개

- AR
- MA
- ARMA
- ARIMA
- SARIMA

### 시계열 기본 가정

주어진 시계열 자료 $Z_1, \dots, Z_n$은 어느 특정한 확률과정의 실현값으로 생각할 수 있으며, 가능한 시계열 모형은 무수히 많으므로 이들 중 일부만 고려하자는 취지에서 나온 것이 정상성 개념임.















